{% extends "layout.html.twig" %}

{% block css %}
    <link rel="stylesheet" href="{{ asset("css/historical.css") }}">
{% endblock %}

{% block title %}{% trans %}Historique{% endtrans %}{% endblock %}

{% block main %}

    <div class="card-container">
        {% set displayedCount = 0 %}
        {% for quiz in liste %}
            {% if displayedCount < 20 %}

                <div class="modal-historique" id="modal-{{ quiz.id }}" style="display: none">

                    <button onclick="closeModal({{ quiz.id }})">
                        <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512">
                            <path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M368 368L144 144M368 144L144 368"/>
                        </svg>
                    </button>

                    <ul>
                        {% for participant in quiz.players %}
                            <li>
                                #{{ loop.index }} - {{ participant.username }} - {{ participant.score }}
                            </li>
                        {% endfor %}
                    </ul>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="date">{{ quiz.date|date('d/m/Y') }}</h3>
                        <h3 class="number">{{ quiz.players|length }} {% trans %}participant(s){% endtrans %}</h3>
                    </div>
                    <div class="card-body">
                        <h2 class="title">{{ quiz.title }}</h2>
                    </div>
                    <div class="card-footer">
                        <button onclick="openModalParticipant({{ quiz.id }})">
                            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512">
                                <path d="M402 168c-2.93 40.67-33.1 72-66 72s-63.12-31.32-66-72c-3-42.31 26.37-72 66-72s69 30.46 66 72z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                                <path d="M336 304c-65.17 0-127.84 32.37-143.54 95.41-2.08 8.34 3.15 16.59 11.72 16.59h263.65c8.57 0 13.77-8.25 11.72-16.59C463.85 335.36 401.18 304 336 304z" fill="none" stroke="currentColor" stroke-miterlimit="10" stroke-width="32"/>
                                <path d="M200 185.94c-2.34 32.48-26.72 58.06-53 58.06s-50.7-25.57-53-58.06C91.61 152.15 115.34 128 147 128s55.39 24.77 53 57.94z" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"/>
                                <path d="M206 306c-18.05-8.27-37.93-11.45-59-11.45-52 0-102.1 25.85-114.65 76.2-1.65 6.66 2.53 13.25 9.37 13.25H154" fill="none" stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="32"/>
                            </svg>
                        </button>
                        <a href="{{ path('delete-historique', {'id': quiz.id}) }}" class="delete-link">
                            <svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512">
                                <path d="M296 64h-80a7.91 7.91 0 00-8 8v24h96V72a7.91 7.91 0 00-8-8z" fill="none"/>
                                <path d="M432 96h-96V72a40 40 0 00-40-40h-80a40 40 0 00-40 40v24H80a16 16 0 000 32h17l19 304.92c1.42 26.85 22 47.08 48 47.08h184c26.13 0 46.3-19.78 48-47l19-305h17a16 16 0 000-32zM192.57 416H192a16 16 0 01-16-15.43l-8-224a16 16 0 1132-1.14l8 224A16 16 0 01192.57 416zM272 400a16 16 0 01-32 0V176a16 16 0 0132 0zm32-304h-96V72a7.91 7.91 0 018-8h80a7.91 7.91 0 018 8zm32 304.57A16 16 0 01320 416h-.58A16 16 0 01304 399.43l8-224a16 16 0 1132 1.14z"/>
                            </svg>
                        </a>
                    </div>
                </div>
                {% set displayedCount = displayedCount + 1 %}
            {% endif %}
        {% endfor %}
    </div>

    {% if liste|length > 20 and displayedCount == 20 %}
        <button id="afficher-plus" class="afficher-plus">Afficher plus</button>
    {% endif %}

    <script>

        function openModalParticipant(id){
            $(`#modal-${id}`).show()
        }

        function closeModal(id){
            $(`#modal-${id}`).hide()
        }

    </script>

{% endblock %}
